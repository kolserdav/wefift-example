"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.PromiseQueue = void 0;
class PromiseQueue {
    constructor() {
        this.queue = [];
        this.running = false;
        this.push = (promise) => new Promise((r, f) => {
            this.queue.push({ promise, done: r, failed: f });
            if (!this.running) {
                this.run();
            }
        });
    }
    async run() {
        const task = this.queue.shift();
        if (task) {
            this.running = true;
            try {
                const res = await task.promise();
                task.done(res);
            }
            catch (error) {
                task.failed(error);
            }
            this.run();
        }
        else {
            this.running = false;
        }
    }
}
exports.PromiseQueue = PromiseQueue;
//# sourceMappingURL=promise.js.map